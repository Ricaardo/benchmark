# æ—¥å¿—ä¸‹è½½åŠŸèƒ½æµ‹è¯•æŒ‡å—

## é—®é¢˜åˆ†æ

å½“å‰æµ‹è¯•è®°å½•é¡µé¢æ²¡æœ‰æ˜¾ç¤ºæ—¥å¿—ä¸‹è½½æŒ‰é’®çš„åŸå› ï¼š
- âœ… å‰ç«¯ä»£ç å·²æ­£ç¡®å®ç°ï¼ˆæ£€æŸ¥ `record.logFile` å­—æ®µï¼‰
- âœ… åç«¯APIå·²æ­£ç¡®å®ç°ï¼ˆä¿å­˜æ—¥å¿—åˆ° `data/logs/`ï¼‰
- âŒ ç°æœ‰æµ‹è¯•è®°å½•æ˜¯åœ¨æ—¥å¿—åŠŸèƒ½å®ç°ä¹‹å‰åˆ›å»ºçš„ï¼Œæ²¡æœ‰ `logFile` å­—æ®µ

## éªŒè¯æ­¥éª¤

### 1. è¿è¡Œæ–°æµ‹è¯•
åœ¨é¦–é¡µè¿è¡Œä»»æ„ä¸€ä¸ªæ–°çš„benchmarkæµ‹è¯•ï¼Œç³»ç»Ÿä¼šï¼š
1. æ•è·æµ‹è¯•è¾“å‡ºåˆ° `task.output`
2. æµ‹è¯•å®Œæˆåä¿å­˜æ—¥å¿—åˆ° `data/logs/task_<id>_<timestamp>.log`
3. åœ¨æµ‹è¯•è®°å½•ä¸­ä¿å­˜ `logFile` å­—æ®µ

### 2. æŸ¥çœ‹æµ‹è¯•è®°å½•
è®¿é—® http://localhost:3000/records.html
- æ–°çš„æµ‹è¯•è®°å½•ä¼šæ˜¾ç¤ºç»¿è‰²çš„ "ğŸ“¥ æ—¥å¿—" æŒ‰é’®
- æ—§çš„æµ‹è¯•è®°å½•ï¼ˆæ²¡æœ‰logFileï¼‰ä¸ä¼šæ˜¾ç¤ºæŒ‰é’®

### 3. ä¸‹è½½æ—¥å¿—
ç‚¹å‡» "ğŸ“¥ æ—¥å¿—" æŒ‰é’®ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨ä¸‹è½½æ—¥å¿—æ–‡ä»¶

### 4. éªŒè¯API
```bash
# 1. æŸ¥çœ‹æœ€æ–°æµ‹è¯•è®°å½•ï¼ˆæ£€æŸ¥logFileå­—æ®µï¼‰
curl 'http://localhost:3000/api/test-records?limit=1' | jq '.records[0]'

# 2. ä¸‹è½½æ—¥å¿—ï¼ˆæ›¿æ¢ä¸ºå®é™…çš„recordIdï¼‰
curl -O 'http://localhost:3000/api/test-records/<recordId>/download-log'

# 3. é¢„è§ˆæ—¥å¿—
curl 'http://localhost:3000/api/test-records/<recordId>/logs' | jq '.'
```

## ä»£ç ä½ç½®

### åç«¯
- æ—¥å¿—ä¿å­˜: [server/index.ts:640-657](server/index.ts#L640-L657)
- ä¸‹è½½API: [server/index.ts:2501-2552](server/index.ts#L2501-L2552)
- é¢„è§ˆAPI: [server/index.ts:2554-2619](server/index.ts#L2554-L2619)

### å‰ç«¯
- ä¸‹è½½æŒ‰é’®: [public/records.html:715-728](public/records.html#L715-L728)
- ä¸‹è½½å‡½æ•°: [public/records.html:1040-1051](public/records.html#L1040-L1051)

## æ–‡ä»¶ç»“æ„

```
benchmark/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ logs/                          # æ—¥å¿—ç›®å½•
â”‚   â”‚   â””â”€â”€ task_<id>_<timestamp>.log  # æ—¥å¿—æ–‡ä»¶
â”‚   â””â”€â”€ test-records.json              # æµ‹è¯•è®°å½•ï¼ˆå«logFileå­—æ®µï¼‰
â””â”€â”€ test-records.json                  # æ—§ç‰ˆæµ‹è¯•è®°å½•ï¼ˆå…¼å®¹ï¼‰
```

## æµ‹è¯•æ•°æ®ç¤ºä¾‹

### å¸¦æ—¥å¿—çš„æµ‹è¯•è®°å½•
```json
{
  "id": "task_1234567890_abc123",
  "name": "é¦–é¡µæ€§èƒ½æµ‹è¯•",
  "runner": "Runtime",
  "status": "completed",
  "startTime": "2025-11-27T12:00:00.000Z",
  "endTime": "2025-11-27T12:01:30.000Z",
  "duration": 90000,
  "logFile": "task_1234567890_abc123_1732708890123.log"  â† æœ‰è¿™ä¸ªå­—æ®µ
}
```

### ä¸å¸¦æ—¥å¿—çš„æ—§æµ‹è¯•è®°å½•
```json
{
  "id": "task_1764215955776_wp3nbofqh",
  "name": "æµ‹è¯•ï¼šå¤šURLä¸åŒé…ç½®",
  "runner": "Runtime",
  "status": "completed",
  "startTime": "2025-11-27T03:59:15.776Z",
  "endTime": "2025-11-27T04:00:40.166Z",
  "duration": 84390
  // æ²¡æœ‰ logFile å­—æ®µï¼Œä¸æ˜¾ç¤ºä¸‹è½½æŒ‰é’®
}
```

## å¿«é€Ÿæµ‹è¯•æ–¹æ³•

### æ–¹æ³•1: é€šè¿‡UIè¿è¡Œæµ‹è¯•
1. è®¿é—® http://localhost:3000
2. é€‰æ‹©ä»»æ„æµ‹è¯•ç”¨ä¾‹
3. ç‚¹å‡»"å¼€å§‹æµ‹è¯•"
4. ç­‰å¾…æµ‹è¯•å®Œæˆ
5. è®¿é—® http://localhost:3000/records.html
6. æŸ¥çœ‹æœ€æ–°è®°å½•ï¼Œåº”è¯¥æœ‰"ğŸ“¥ æ—¥å¿—"æŒ‰é’®

### æ–¹æ³•2: æ‰‹åŠ¨åˆ›å»ºæµ‹è¯•æ—¥å¿—ï¼ˆç”¨äºæ¼”ç¤ºï¼‰
```bash
# åˆ›å»ºæ—¥å¿—ç›®å½•
mkdir -p data/logs

# åˆ›å»ºç¤ºä¾‹æ—¥å¿—æ–‡ä»¶
cat > data/logs/task_test_12345.log << 'EOF'
[2025-11-27 12:00:00] å¼€å§‹æµ‹è¯•...
[2025-11-27 12:00:01] åŠ è½½é¡µé¢: https://www.bilibili.com
[2025-11-27 12:00:05] FCP: 1234ms
[2025-11-27 12:00:10] LCP: 2345ms
[2025-11-27 12:01:00] æµ‹è¯•å®Œæˆ
EOF

# æ‰‹åŠ¨æ·»åŠ è®°å½•åˆ°test-records.jsonï¼ˆéœ€è¦ç¼–è¾‘JSONï¼‰
# æ·»åŠ  "logFile": "task_test_12345.log" å­—æ®µ
```

## é¢„æœŸç»“æœ

è¿è¡Œæ–°æµ‹è¯•åï¼š
- âœ… `data/logs/` ç›®å½•ä¸‹ä¼šæœ‰æ–°çš„ `.log` æ–‡ä»¶
- âœ… æµ‹è¯•è®°å½•é¡µé¢æ˜¾ç¤ºç»¿è‰²ä¸‹è½½æŒ‰é’®
- âœ… ç‚¹å‡»æŒ‰é’®å¯ä»¥ä¸‹è½½æ—¥å¿—æ–‡ä»¶
- âœ… æµè§ˆå™¨æ§åˆ¶å°æ˜¾ç¤º: `ç¬¬ä¸€æ¡è®°å½•çš„logFile: task_xxx.log`

## è°ƒè¯•ä¿¡æ¯

æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰ï¼Œåˆ·æ–°æµ‹è¯•è®°å½•é¡µé¢ï¼Œä¼šçœ‹åˆ°ï¼š
```
ç¬¬ä¸€æ¡è®°å½•çš„logFile: undefined  // å¦‚æœæ˜¯æ—§è®°å½•
ç¬¬ä¸€æ¡è®°å½•çš„logFile: task_xxx_xxx.log  // å¦‚æœæ˜¯æ–°è®°å½•
```
