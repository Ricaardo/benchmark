# 📊 数据可视化功能指南

## 概述

数据可视化功能提供了强大的图表展示和多 URL 性能对比能力，让您能够直观地分析和对比测试结果。

---

## 🎯 核心功能

### 1. **多 URL 性能对比**

支持同时选择多个 URL 进行性能对比，清晰展示各项指标的差异。

#### 特性：
- ✅ 最多同时对比 12 个 URL
- ✅ 自动颜色编码，每个 URL 有独立颜色
- ✅ 支持勾选/取消勾选 URL
- ✅ 实时更新图表

### 2. **丰富的图表类型**

提供 6 种不同类型的图表，全方位展示测试数据。

---

## 📈 图表类型详解

### 标签页 1: ⚡ 性能对比

#### 1.1 加载时间对比（柱状图）

**用途**：直观对比不同 URL 的页面加载时间

**指标**：
- 总加载时间（秒）

**示例**：
```
B站首页:     1.2s  ▓▓▓▓▓▓
视频播放页:   1.8s  ▓▓▓▓▓▓▓▓▓
动态页:      1.5s  ▓▓▓▓▓▓▓▓
```

**解读**：
- ✅ 柱子越短，加载速度越快
- 🎯 理想值：< 2.0s

---

#### 1.2 资源大小对比（分组柱状图）

**用途**：对比不同资源类型的大小

**指标**：
- JavaScript 大小（KB）
- CSS 大小（KB）
- 图片大小（KB）

**示例**：
```
        JS     CSS    图片
首页:   250KB  80KB   1200KB
视频页: 450KB  120KB  800KB
```

**解读**：
- 📦 识别资源过大的页面
- 🎯 优化目标：减少不必要的资源加载

---

#### 1.3 性能指标雷达图

**用途**：多维度综合评估页面性能

**指标**（6 个维度）：
1. **加载速度** - 总体加载时间
2. **FCP** - 首次内容绘制
3. **LCP** - 最大内容绘制
4. **TTI** - 可交互时间
5. **CLS** - 累积布局偏移
6. **FID** - 首次输入延迟

**示例**：
```
        加载速度
          /\
         /  \
    FCP /    \ TTI
       /      \
      /________\
    LCP        CLS
         FID
```

**解读**：
- 雷达图面积越大，性能越好
- 标准化为 0-100 分，100 分最佳
- 方便快速识别性能短板

---

### 标签页 2: 📅 时间趋势

#### 2.1 性能趋势图（折线图）

**用途**：观察多次测试中的性能变化趋势

**X 轴**：测试次数（第1次、第2次、...）
**Y 轴**：加载时间（秒）

**示例**：
```
3.0s│
    │     URL2 ──╮
2.5s│            ╰──╮
    │               ╰──
2.0s│  URL1 ──────────
    │
1.5s│
    └──────────────────
     1  2  3  4  5 次
```

**解读**：
- 📉 下降趋势：性能改善（可能是缓存生效）
- 📈 上升趋势：性能下降（需要关注）
- ➡️ 平稳趋势：性能稳定

---

#### 2.2 内存使用趋势（折线图）

**用途**：监控页面运行时的内存变化

**X 轴**：时间点（初始、10s、20s、...）
**Y 轴**：内存使用（MB）

**示例**：
```
80MB│        URL2 ─╱╱
    │            ╱
60MB│       ╱╱╱
    │  URL1 ─────
40MB│
    └─────────────────
     0   10  20  30 秒
```

**解读**：
- ⬆️ 持续上升：可能存在内存泄漏
- ➡️ 趋于平稳：内存使用正常
- 🎯 理想情况：初始低，后期平稳

---

### 标签页 3: 📊 详细对比

#### 3.1 详细数据对比表

**用途**：精确查看所有性能指标的数值对比

**包含指标**：

| 指标 | 说明 | 单位 | 理想值 |
|------|------|------|--------|
| **加载时间** | 页面完全加载时间 | 秒 | < 2.0s |
| **FCP** | 首次内容绘制 | 秒 | < 1.0s |
| **LCP** | 最大内容绘制 | 秒 | < 2.5s |
| **TTI** | 可交互时间 | 秒 | < 3.0s |
| **CLS** | 累积布局偏移 | 无 | < 0.1 |
| **FID** | 首次输入延迟 | 毫秒 | < 100ms |
| **JS大小** | JavaScript 资源 | KB | 越小越好 |
| **CSS大小** | CSS 资源 | KB | 越小越好 |
| **内存使用** | 初始内存占用 | MB | 越小越好 |

**颜色标识**：
- 🟢 **绿色** = 最佳值（该指标中表现最好）
- 🔴 **红色** = 最差值（该指标中表现最差）
- ⚪ **白色** = 中间值

**示例**：
```
指标      | B站首页  | 视频页   | 动态页
--------- | -------- | -------- | --------
加载时间  | 1.2s 🟢  | 1.8s 🔴  | 1.5s
FCP       | 0.5s 🟢  | 0.9s     | 0.7s
LCP       | 1.0s 🟢  | 1.6s 🔴  | 1.3s
```

---

## 📋 数据概览卡片

页面顶部展示 4 个关键指标的平均值：

### 1. 平均加载时间
- **计算方式**：所有选中 URL 的加载时间平均值
- **用途**：快速了解整体性能水平

### 2. 首次内容绘制 (FCP)
- **意义**：用户看到页面第一个元素的时间
- **目标**：< 1.0s（良好）

### 3. 最大内容绘制 (LCP)
- **意义**：页面主要内容可见的时间
- **目标**：< 2.5s（良好）

### 4. 可交互时间 (TTI)
- **意义**：页面完全可交互的时间
- **目标**：< 3.0s（良好）

---

## 🎮 使用方式

### 步骤 1: 选择测试用例

1. 点击主页的 **"📊 数据可视化"** 按钮
2. 在下拉菜单中选择一个测试用例

### 步骤 2: 选择 URL

自动展示该测试用例中的所有 URL，默认全选：

```
☑ B站首页 (https://www.bilibili.com)
☑ 视频播放页 (https://www.bilibili.com/video/...)
☑ 动态页 (https://t.bilibili.com)
```

**操作**：
- 取消勾选：隐藏该 URL 的数据
- 重新勾选：显示该 URL 的数据
- 图表会实时更新

### 步骤 3: 选择测试类型

根据需要选择：
- **Initialization** - 查看初始化性能数据
- **Runtime** - 查看运行时性能数据
- **MemoryLeak** - 查看内存泄漏检测数据

### 步骤 4: 切换图表标签页

- **⚡ 性能对比** - 静态指标对比
- **📅 时间趋势** - 动态趋势分析
- **📊 详细对比** - 精确数值对比

---

## 🎨 颜色编码系统

每个 URL 自动分配一个独特的颜色，便于识别：

| URL 序号 | 颜色 | 十六进制 |
|---------|------|----------|
| 1 | 🔵 蓝色 | #4299e1 |
| 2 | 🟢 绿色 | #48bb78 |
| 3 | 🟠 橙色 | #ed8936 |
| 4 | 🟣 紫色 | #9f7aea |
| 5 | 🔴 红色 | #f56565 |
| 6 | 🔷 青色 | #38b2ac |
| 7 | 🟡 黄色 | #ecc94b |
| 8 | 🌸 粉色 | #ed64a6 |

**用途**：
- 图例中使用该颜色
- 图表数据线/柱子使用该颜色
- URL 选择器中显示该颜色标识

---

## 💡 实战示例

### 场景 1: 多页面加载性能对比

**目标**：对比 B站首页、视频页、动态页的加载性能

**步骤**：
1. 选择测试用例："B站主要页面性能测试"
2. 确保 3 个 URL 全部勾选
3. 选择测试类型："Initialization"
4. 查看 **性能对比 → 加载时间对比**

**分析**：
```
结果显示：
- 首页:     1.2s  ✅ 最快
- 动态页:   1.5s  ✓ 正常
- 视频页:   1.8s  ⚠️ 稍慢
```

**结论**：视频页加载较慢，可能需要优化资源加载

---

### 场景 2: 资源大小优化前后对比

**目标**：对比优化前后的资源大小变化

**步骤**：
1. 准备两个测试用例：
   - "优化前" - 原始页面
   - "优化后" - 优化资源后的页面
2. 分别查看 **资源大小对比图**

**分析**：
```
优化前：
- JS: 450KB
- CSS: 120KB
- 图片: 1500KB

优化后：
- JS: 280KB  ↓ 37%
- CSS: 80KB   ↓ 33%
- 图片: 900KB ↓ 40%
```

**结论**：优化效果显著，总资源减少 38%

---

### 场景 3: 内存泄漏检测

**目标**：识别是否存在内存泄漏

**步骤**：
1. 选择测试类型："MemoryLeak"
2. 查看 **时间趋势 → 内存使用趋势**

**分析**：
```
正常情况：
内存 ──────── (平稳)

内存泄漏：
内存 ╱╱╱╱╱ (持续上升)
```

**结论**：如果内存持续上升不回落，需要检查代码中的内存泄漏

---

### 场景 4: 性能全面评估

**目标**：全面了解页面性能状况

**步骤**：
1. 查看 **性能指标雷达图**
2. 分析各个维度的得分

**分析**：
```
雷达图显示：
- 加载速度: 85/100  ✅
- FCP:       90/100  ✅
- LCP:       75/100  ✓
- TTI:       70/100  ⚠️
- CLS:       95/100  ✅
- FID:       80/100  ✓
```

**结论**：TTI（可交互时间）较差，需要优化 JavaScript 执行

---

## 🔧 技术细节

### 使用的图表库

**Chart.js 4.4.0**
- 官方文档：https://www.chartjs.org/
- CDN 加载，无需安装依赖
- 支持响应式设计

### 图表配置

所有图表支持：
- ✅ 响应式布局（自动适应屏幕大小）
- ✅ 悬停提示（Tooltip）
- ✅ 图例显示/隐藏
- ✅ 平滑动画

### 数据来源

**当前版本**：
- 使用模拟数据进行演示
- 数据随机生成，符合真实场景

**未来版本**：
- 从后端 API 获取真实测试数据
- 支持历史数据查询
- 支持数据导出

---

## 📊 性能指标说明

### Core Web Vitals (核心网页指标)

#### 1. LCP (Largest Contentful Paint) - 最大内容绘制

**定义**：页面主要内容可见的时间

**评分标准**：
- 🟢 良好：< 2.5s
- 🟡 需要改进：2.5s - 4.0s
- 🔴 差：> 4.0s

**优化建议**：
- 优化服务器响应时间
- 预加载关键资源
- 优化图片大小

---

#### 2. FID (First Input Delay) - 首次输入延迟

**定义**：用户首次交互到浏览器响应的时间

**评分标准**：
- 🟢 良好：< 100ms
- 🟡 需要改进：100ms - 300ms
- 🔴 差：> 300ms

**优化建议**：
- 减少 JavaScript 执行时间
- 分割长任务
- 使用 Web Workers

---

#### 3. CLS (Cumulative Layout Shift) - 累积布局偏移

**定义**：页面元素意外移动的程度

**评分标准**：
- 🟢 良好：< 0.1
- 🟡 需要改进：0.1 - 0.25
- 🔴 差：> 0.25

**优化建议**：
- 为图片和视频预留空间
- 避免在现有内容上方插入内容
- 使用 CSS `aspect-ratio`

---

### 其他重要指标

#### FCP (First Contentful Paint) - 首次内容绘制

**定义**：页面第一个 DOM 内容渲染的时间

**目标**：< 1.0s

---

#### TTI (Time to Interactive) - 可交互时间

**定义**：页面完全可交互的时间

**目标**：< 3.0s

---

## 🎉 总结

数据可视化功能提供了：

✅ **6 种图表类型** - 全方位展示性能数据
✅ **多 URL 对比** - 最多同时对比 12 个 URL
✅ **3 个标签页** - 性能对比、时间趋势、详细数据
✅ **实时更新** - 勾选/取消 URL 即时更新图表
✅ **颜色编码** - 每个 URL 独立颜色，易于识别
✅ **数据概览** - 4 个关键指标卡片快速了解
✅ **响应式设计** - 适配各种屏幕尺寸

**立即使用**：点击主页的 **"📊 数据可视化"** 按钮开始探索！🚀

---

## 📞 相关文档

- [README.md](README.md) - 主文档
- [QUICKSTART.md](QUICKSTART.md) - 快速开始
- [URL_DESCRIPTIONS.md](URL_DESCRIPTIONS.md) - URL 描述功能

---

**最后更新**: 2025-10-29
