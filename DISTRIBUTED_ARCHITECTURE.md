# ğŸŒ åˆ†å¸ƒå¼æ‰§è¡Œæ¶æ„è®¾è®¡

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜å¦‚ä½•å®ç°å¤šå°ç”µè„‘éƒ¨ç½²åï¼Œåœ¨å‰ç«¯é€‰æ‹©æ‰§è¡ŒèŠ‚ç‚¹çš„åˆ†å¸ƒå¼æ¶æ„ã€‚

---

## ğŸ“‹ ç›®å½•

- [æ¶æ„æ¦‚è§ˆ](#æ¶æ„æ¦‚è§ˆ)
- [æ ¸å¿ƒæ¦‚å¿µ](#æ ¸å¿ƒæ¦‚å¿µ)
- [å·¥ä½œæµç¨‹](#å·¥ä½œæµç¨‹)
- [éƒ¨ç½²æ–¹æ¡ˆ](#éƒ¨ç½²æ–¹æ¡ˆ)
- [API è®¾è®¡](#api-è®¾è®¡)
- [å‰ç«¯ç•Œé¢](#å‰ç«¯ç•Œé¢)
- [å®ç°æ­¥éª¤](#å®ç°æ­¥éª¤)

---

## ğŸ¯ æ¶æ„æ¦‚è§ˆ

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æµè§ˆå™¨å®¢æˆ·ç«¯                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  å‰ç«¯ç•Œé¢ (index.html)                                â”‚  â”‚
â”‚  â”‚  - èŠ‚ç‚¹åˆ—è¡¨å±•ç¤º                                       â”‚  â”‚
â”‚  â”‚  - èŠ‚ç‚¹çŠ¶æ€ç›‘æ§                                       â”‚  â”‚
â”‚  â”‚  - æ‰§è¡ŒèŠ‚ç‚¹é€‰æ‹©å™¨                                     â”‚  â”‚
â”‚  â”‚  - å®æ—¶ä»»åŠ¡ç›‘æ§                                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ WebSocket + REST API
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Master èŠ‚ç‚¹ (ä¸»æ§æœåŠ¡å™¨)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  server/index.ts (ç°æœ‰æœåŠ¡å™¨æ‰©å±•)                      â”‚  â”‚
â”‚  â”‚  - èŠ‚ç‚¹æ³¨å†Œç®¡ç† (WorkerRegistry)                      â”‚  â”‚
â”‚  â”‚  - å¿ƒè·³æ£€æµ‹ (HeartbeatMonitor)                       â”‚  â”‚
â”‚  â”‚  - ä»»åŠ¡åˆ†å‘è°ƒåº¦ (TaskDispatcher)                     â”‚  â”‚
â”‚  â”‚  - çŠ¶æ€åŒæ­¥ (StateSynchronizer)                      â”‚  â”‚
â”‚  â”‚  - ç»“æœèšåˆ (ResultAggregator)                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                              â”‚
â”‚  å­˜å‚¨:                                                       â”‚
â”‚  - workers.json (èŠ‚ç‚¹æ³¨å†Œä¿¡æ¯)                              â”‚
â”‚  - distributed-tasks.json (åˆ†å¸ƒå¼ä»»åŠ¡è®°å½•)                  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚              â”‚              â”‚              â”‚
     â”‚ WebSocket    â”‚ WebSocket    â”‚ WebSocket    â”‚ WebSocket
     â”‚ + REST API   â”‚ + REST API   â”‚ + REST API   â”‚ + REST API
     â”‚              â”‚              â”‚              â”‚
â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Worker 1    â”‚ â”‚  Worker 2   â”‚ â”‚  Worker 3   â”‚ â”‚  Worker N  â”‚
â”‚  (Windows)   â”‚ â”‚  (macOS)    â”‚ â”‚  (Linux)    â”‚ â”‚  (Any OS)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ worker.ts    â”‚ â”‚ worker.ts   â”‚ â”‚ worker.ts   â”‚ â”‚ worker.ts  â”‚
â”‚ - æ³¨å†Œåˆ°Masterâ”‚ â”‚ - æ³¨å†Œåˆ°Masterâ”‚ â”‚ - æ³¨å†Œåˆ°Masterâ”‚ â”‚ - æ³¨å†Œåˆ°Masterâ”‚
â”‚ - å¿ƒè·³ä¸ŠæŠ¥   â”‚ â”‚ - å¿ƒè·³ä¸ŠæŠ¥  â”‚ â”‚ - å¿ƒè·³ä¸ŠæŠ¥  â”‚ â”‚ - å¿ƒè·³ä¸ŠæŠ¥ â”‚
â”‚ - æ¥æ”¶ä»»åŠ¡   â”‚ â”‚ - æ¥æ”¶ä»»åŠ¡  â”‚ â”‚ - æ¥æ”¶ä»»åŠ¡  â”‚ â”‚ - æ¥æ”¶ä»»åŠ¡ â”‚
â”‚ - æ‰§è¡Œæµ‹è¯•   â”‚ â”‚ - æ‰§è¡Œæµ‹è¯•  â”‚ â”‚ - æ‰§è¡Œæµ‹è¯•  â”‚ â”‚ - æ‰§è¡Œæµ‹è¯• â”‚
â”‚ - ä¸ŠæŠ¥ç»“æœ   â”‚ â”‚ - ä¸ŠæŠ¥ç»“æœ  â”‚ â”‚ - ä¸ŠæŠ¥ç»“æœ  â”‚ â”‚ - ä¸ŠæŠ¥ç»“æœ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µ

### 1. Master èŠ‚ç‚¹ï¼ˆä¸»æ§æœåŠ¡å™¨ï¼‰

**èŒè´£ï¼š**
- ç®¡ç†æ‰€æœ‰ Worker èŠ‚ç‚¹çš„æ³¨å†Œå’Œæ³¨é”€
- ç›‘æ§ Worker èŠ‚ç‚¹çš„å¥åº·çŠ¶æ€
- æ¥æ”¶å‰ç«¯çš„ä»»åŠ¡è¯·æ±‚
- å°†ä»»åŠ¡åˆ†å‘åˆ°æŒ‡å®šçš„ Worker èŠ‚ç‚¹
- æ”¶é›†å’Œå±•ç¤ºä»»åŠ¡æ‰§è¡Œç»“æœ
- æä¾› WebSocket å®æ—¶é€šä¿¡
- æä¾› REST API æ¥å£

**éƒ¨ç½²ï¼š**
- åªéœ€è¦éƒ¨ç½²ä¸€ä¸ª Master èŠ‚ç‚¹
- é€šå¸¸éƒ¨ç½²åœ¨ç¨³å®šçš„æœåŠ¡å™¨ä¸Š
- éœ€è¦å›ºå®šçš„ IP åœ°å€æˆ–åŸŸå

### 2. Worker èŠ‚ç‚¹ï¼ˆæ‰§è¡ŒèŠ‚ç‚¹ï¼‰

**èŒè´£ï¼š**
- å¯åŠ¨æ—¶å‘ Master æ³¨å†Œ
- å®šæœŸå‘é€å¿ƒè·³ä¿æŒè¿æ¥
- æ¥æ”¶ Master åˆ†å‘çš„ä»»åŠ¡
- æ‰§è¡Œæ€§èƒ½æµ‹è¯•
- ä¸ŠæŠ¥æ‰§è¡Œç»“æœå’Œæ—¥å¿—
- å¤„ç†ä»»åŠ¡å–æ¶ˆè¯·æ±‚

**éƒ¨ç½²ï¼š**
- å¯ä»¥éƒ¨ç½²å¤šä¸ª Worker èŠ‚ç‚¹
- æ”¯æŒä¸åŒæ“ä½œç³»ç»Ÿï¼ˆWindows/macOS/Linuxï¼‰
- æ”¯æŒä¸åŒé…ç½®çš„æœºå™¨
- å¯ä»¥åŠ¨æ€å¢åŠ æˆ–å‡å°‘

### 3. èŠ‚ç‚¹æ ‡è¯†

æ¯ä¸ª Worker èŠ‚ç‚¹åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š

```typescript
interface WorkerNode {
    id: string;              // å”¯ä¸€æ ‡è¯† (UUID)
    name: string;            // èŠ‚ç‚¹åç§° (ç”¨æˆ·è‡ªå®šä¹‰)
    host: string;            // IPåœ°å€
    port: number;            // ç«¯å£å·
    platform: string;        // æ“ä½œç³»ç»Ÿ (win32/darwin/linux)
    arch: string;            // CPUæ¶æ„ (x64/arm64)
    cpuCount: number;        // CPUæ ¸å¿ƒæ•°
    memory: number;          // å†…å­˜å¤§å° (GB)
    status: 'online' | 'offline' | 'busy';  // çŠ¶æ€
    lastHeartbeat: number;   // æœ€åå¿ƒè·³æ—¶é—´
    currentTask?: string;    // å½“å‰æ‰§è¡Œçš„ä»»åŠ¡ID
    capabilities: string[];  // èƒ½åŠ›æ ‡ç­¾ (å¦‚: ['chromium', 'firefox'])
    tags: string[];          // è‡ªå®šä¹‰æ ‡ç­¾ (å¦‚: ['production', 'testing'])
}
```

---

## ğŸ”„ å·¥ä½œæµç¨‹

### æµç¨‹ 1: Worker èŠ‚ç‚¹æ³¨å†Œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Worker â”‚                    â”‚ Master â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
    â”‚                             â”‚
    â”‚  1. å¯åŠ¨ Worker              â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>  â”‚
    â”‚                             â”‚
    â”‚  2. POST /api/workers/register â”‚
    â”‚  { id, name, host, platform, ... } â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>  â”‚
    â”‚                             â”‚
    â”‚                             â”‚  3. éªŒè¯å¹¶ä¿å­˜èŠ‚ç‚¹ä¿¡æ¯
    â”‚                             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
    â”‚                             â”‚
    â”‚  4. è¿”å›æ³¨å†ŒæˆåŠŸ            â”‚
    â”‚  { success: true, workerId } â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚                             â”‚
    â”‚  5. å»ºç«‹ WebSocket è¿æ¥     â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚
    â”‚                             â”‚
    â”‚  6. å¼€å§‹å¿ƒè·³å¾ªç¯ (æ¯30ç§’)    â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>  â”‚
    â”‚                             â”‚
```

### æµç¨‹ 2: ç”¨æˆ·é€‰æ‹©èŠ‚ç‚¹æ‰§è¡Œä»»åŠ¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯UI â”‚          â”‚ Master â”‚          â”‚ Worker â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
    â”‚                   â”‚                   â”‚
    â”‚  1. è·å–èŠ‚ç‚¹åˆ—è¡¨  â”‚                   â”‚
    â”‚  GET /api/workers â”‚                   â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>  â”‚                   â”‚
    â”‚                   â”‚                   â”‚
    â”‚  2. è¿”å›èŠ‚ç‚¹åˆ—è¡¨  â”‚                   â”‚
    â”‚  [worker1, worker2,...] â”‚             â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚                   â”‚
    â”‚                   â”‚                   â”‚
    â”‚  3. ç”¨æˆ·é€‰æ‹© Worker 1 æ‰§è¡Œä»»åŠ¡         â”‚
    â”‚  POST /api/tasks  â”‚                   â”‚
    â”‚  { testCaseId, workerId: "worker1" }  â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>  â”‚                   â”‚
    â”‚                   â”‚                   â”‚
    â”‚                   â”‚  4. åˆ†å‘ä»»åŠ¡åˆ° Worker 1 â”‚
    â”‚                   â”‚  WebSocket: task-assigned â”‚
    â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>  â”‚
    â”‚                   â”‚                   â”‚
    â”‚                   â”‚                   â”‚  5. Worker æ‰§è¡Œä»»åŠ¡
    â”‚                   â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
    â”‚                   â”‚                   â”‚
    â”‚                   â”‚  6. å®æ—¶ä¸ŠæŠ¥è¿›åº¦  â”‚
    â”‚                   â”‚  WebSocket: task-progress â”‚
    â”‚                   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚                   â”‚                   â”‚
    â”‚  7. è½¬å‘è¿›åº¦åˆ°å‰ç«¯ â”‚                  â”‚
    â”‚  WebSocket: log   â”‚                   â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚                   â”‚
    â”‚                   â”‚                   â”‚
    â”‚                   â”‚  8. ä¸ŠæŠ¥ä»»åŠ¡å®Œæˆ  â”‚
    â”‚                   â”‚  POST /api/tasks/:id/complete â”‚
    â”‚                   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚                   â”‚                   â”‚
    â”‚  9. é€šçŸ¥å‰ç«¯å®Œæˆ   â”‚                  â”‚
    â”‚  WebSocket: task-completed â”‚          â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚                   â”‚
```

### æµç¨‹ 3: å¿ƒè·³å’Œå¥åº·æ£€æŸ¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Worker â”‚                    â”‚ Master â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
    â”‚                             â”‚
    â”‚  æ¯ 30 ç§’å‘é€å¿ƒè·³             â”‚
    â”‚  POST /api/workers/:id/heartbeat â”‚
    â”‚  { cpuUsage, memUsage, ... }â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>  â”‚
    â”‚                             â”‚
    â”‚                             â”‚  æ›´æ–° lastHeartbeat
    â”‚                             â”‚  æ£€æŸ¥èŠ‚ç‚¹çŠ¶æ€
    â”‚                             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
    â”‚                             â”‚
    â”‚  è¿”å›ç¡®è®¤                    â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚                             â”‚
    â”‚                             â”‚
    â”‚  (è¶…è¿‡ 90 ç§’æœªæ”¶åˆ°å¿ƒè·³)        â”‚
    â”‚                             â”‚  æ ‡è®°èŠ‚ç‚¹ä¸º offline
    â”‚                             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
    â”‚                             â”‚
    â”‚                             â”‚  é€šçŸ¥å‰ç«¯èŠ‚ç‚¹ç¦»çº¿
    â”‚                             â”‚  WebSocket: worker-offline
    â”‚                             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
```

---

## ğŸš€ éƒ¨ç½²æ–¹æ¡ˆ

### æ–¹æ¡ˆ 1: æ··åˆéƒ¨ç½²ï¼ˆæ¨èï¼‰

**Master èŠ‚ç‚¹ï¼š**
```bash
# åœ¨æœåŠ¡å™¨ A (IP: 192.168.1.100)
cd benchmark
npm install
npm run build

# å¯åŠ¨ Master æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰
npm start
# æˆ–ä½¿ç”¨ PM2
pm2 start ecosystem.config.js
```

**Worker èŠ‚ç‚¹ï¼š**
```bash
# åœ¨ç”µè„‘ B (Windows)
cd benchmark
npm install
npm run build

# å¯åŠ¨ Worker æ¨¡å¼
WORKER_MODE=true MASTER_URL=http://192.168.1.100:3000 npm start

# åœ¨ç”µè„‘ C (macOS)
WORKER_MODE=true MASTER_URL=http://192.168.1.100:3000 npm start

# åœ¨ç”µè„‘ D (Linux)
WORKER_MODE=true MASTER_URL=http://192.168.1.100:3000 npm start
```

### æ–¹æ¡ˆ 2: Docker éƒ¨ç½²

**Master èŠ‚ç‚¹ï¼š**
```bash
# docker-compose.yml
version: '3.8'
services:
  benchmark-master:
    build: .
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
      - WORKER_MODE=false
    volumes:
      - ./data:/app/data

docker-compose up -d
```

**Worker èŠ‚ç‚¹ï¼š**
```bash
# åœ¨æ¯å°ç”µè„‘ä¸Š
docker run -d \
  -e WORKER_MODE=true \
  -e MASTER_URL=http://192.168.1.100:3000 \
  -e WORKER_NAME="Windows-PC-1" \
  benchmark-web
```

---

## ğŸ”Œ API è®¾è®¡

### Worker ç®¡ç† API

#### 1. æ³¨å†Œ Worker èŠ‚ç‚¹

```http
POST /api/workers/register
Content-Type: application/json

{
  "name": "Windows-PC-1",
  "host": "192.168.1.101",
  "port": 3001,
  "platform": "win32",
  "arch": "x64",
  "cpuCount": 8,
  "memory": 16,
  "capabilities": ["chromium", "firefox"],
  "tags": ["production"]
}

Response:
{
  "success": true,
  "workerId": "uuid-xxxx-xxxx",
  "message": "Worker registered successfully"
}
```

#### 2. è·å–æ‰€æœ‰ Worker èŠ‚ç‚¹

```http
GET /api/workers

Response:
{
  "workers": [
    {
      "id": "worker-1",
      "name": "Windows-PC-1",
      "host": "192.168.1.101",
      "platform": "win32",
      "status": "online",
      "lastHeartbeat": 1640000000000,
      "currentTask": null,
      "cpuUsage": 25.5,
      "memoryUsage": 45.2
    },
    ...
  ]
}
```

#### 3. è·å–å•ä¸ª Worker è¯¦æƒ…

```http
GET /api/workers/:workerId

Response:
{
  "id": "worker-1",
  "name": "Windows-PC-1",
  "host": "192.168.1.101",
  "platform": "win32",
  "status": "online",
  "taskHistory": [...],
  "performance": {...}
}
```

#### 4. Worker å¿ƒè·³

```http
POST /api/workers/:workerId/heartbeat
Content-Type: application/json

{
  "cpuUsage": 25.5,
  "memoryUsage": 45.2,
  "status": "online"
}

Response:
{
  "success": true,
  "message": "Heartbeat received"
}
```

#### 5. æ³¨é”€ Worker

```http
DELETE /api/workers/:workerId

Response:
{
  "success": true,
  "message": "Worker unregistered"
}
```

### åˆ†å¸ƒå¼ä»»åŠ¡ API

#### 1. åˆ›å»ºåˆ†å¸ƒå¼ä»»åŠ¡

```http
POST /api/distributed-tasks
Content-Type: application/json

{
  "testCaseId": "test-case-1",
  "workerId": "worker-1",  // æŒ‡å®šæ‰§è¡ŒèŠ‚ç‚¹
  "runner": "Runtime"
}

Response:
{
  "success": true,
  "taskId": "task-uuid",
  "workerId": "worker-1",
  "workerName": "Windows-PC-1",
  "status": "dispatched"
}
```

#### 2. è·å–åˆ†å¸ƒå¼ä»»åŠ¡åˆ—è¡¨

```http
GET /api/distributed-tasks?workerId=worker-1&status=running

Response:
{
  "tasks": [
    {
      "id": "task-1",
      "testCaseId": "test-case-1",
      "workerId": "worker-1",
      "workerName": "Windows-PC-1",
      "status": "running",
      "startTime": 1640000000000,
      "progress": 45
    }
  ]
}
```

---

## ğŸ¨ å‰ç«¯ç•Œé¢

### 1. èŠ‚ç‚¹ç®¡ç†é¢æ¿

åœ¨ `index.html` ä¸­æ·»åŠ èŠ‚ç‚¹é€‰æ‹©å™¨ï¼š

```html
<!-- èŠ‚ç‚¹ç®¡ç†é¢æ¿ -->
<div class="worker-panel">
    <h3>ğŸ–¥ï¸ æ‰§è¡ŒèŠ‚ç‚¹</h3>

    <!-- èŠ‚ç‚¹åˆ—è¡¨ -->
    <div class="worker-list">
        <div class="worker-card online" data-worker-id="worker-1">
            <div class="worker-header">
                <span class="worker-name">Windows-PC-1</span>
                <span class="worker-status online">åœ¨çº¿</span>
            </div>
            <div class="worker-info">
                <span>ğŸ–¥ï¸ Windows 10</span>
                <span>ğŸ’» 8æ ¸ 16GB</span>
                <span>ğŸ“Š CPU: 25%</span>
            </div>
            <div class="worker-task">
                å½“å‰ä»»åŠ¡: æ— 
            </div>
        </div>

        <div class="worker-card busy" data-worker-id="worker-2">
            <div class="worker-header">
                <span class="worker-name">macOS-MBP</span>
                <span class="worker-status busy">æ‰§è¡Œä¸­</span>
            </div>
            <div class="worker-info">
                <span>ğŸ macOS 14</span>
                <span>ğŸ’» 10æ ¸ 32GB</span>
                <span>ğŸ“Š CPU: 85%</span>
            </div>
            <div class="worker-task">
                å½“å‰ä»»åŠ¡: Runtime æ€§èƒ½æµ‹è¯•
            </div>
        </div>

        <div class="worker-card offline" data-worker-id="worker-3">
            <div class="worker-header">
                <span class="worker-name">Linux-Server</span>
                <span class="worker-status offline">ç¦»çº¿</span>
            </div>
            <div class="worker-info">
                <span>ğŸ§ Ubuntu 22.04</span>
                <span>ğŸ’» 16æ ¸ 64GB</span>
                <span>ğŸ“Š -</span>
            </div>
            <div class="worker-task">
                æœ€ååœ¨çº¿: 5åˆ†é’Ÿå‰
            </div>
        </div>
    </div>
</div>

<!-- è¿è¡Œæµ‹è¯•æ—¶çš„èŠ‚ç‚¹é€‰æ‹© -->
<div class="node-selector">
    <label>é€‰æ‹©æ‰§è¡ŒèŠ‚ç‚¹:</label>
    <select id="workerSelect">
        <option value="">è‡ªåŠ¨åˆ†é…</option>
        <option value="worker-1">Windows-PC-1 (åœ¨çº¿)</option>
        <option value="worker-2" disabled>macOS-MBP (æ‰§è¡Œä¸­)</option>
        <option value="worker-3" disabled>Linux-Server (ç¦»çº¿)</option>
    </select>
</div>
```

### 2. èŠ‚ç‚¹çŠ¶æ€å®æ—¶æ›´æ–°

```javascript
// WebSocket æ¥æ”¶èŠ‚ç‚¹çŠ¶æ€æ›´æ–°
ws.on('worker-status-update', (data) => {
    const { workerId, status, cpuUsage, currentTask } = data;

    // æ›´æ–°èŠ‚ç‚¹å¡ç‰‡
    updateWorkerCard(workerId, {
        status,
        cpuUsage,
        currentTask
    });

    // æ›´æ–°èŠ‚ç‚¹é€‰æ‹©å™¨
    updateWorkerSelector(workerId, status);
});

// æ›´æ–°èŠ‚ç‚¹å¡ç‰‡
function updateWorkerCard(workerId, data) {
    const card = document.querySelector(`[data-worker-id="${workerId}"]`);
    card.className = `worker-card ${data.status}`;
    card.querySelector('.worker-status').textContent = getStatusText(data.status);
    card.querySelector('.worker-task').textContent =
        data.currentTask || 'å½“å‰ä»»åŠ¡: æ— ';
}
```

---

## ğŸ“ å®ç°æ­¥éª¤

### Phase 1: åŸºç¡€æ¶æ„ï¼ˆç¬¬1å‘¨ï¼‰

- [ ] åˆ›å»º Worker èŠ‚ç‚¹ç±»å‹å®šä¹‰
- [ ] å®ç°èŠ‚ç‚¹æ³¨å†Œç®¡ç†å™¨
- [ ] å®ç°å¿ƒè·³æ£€æµ‹æœºåˆ¶
- [ ] æ·»åŠ èŠ‚ç‚¹å­˜å‚¨ï¼ˆworkers.jsonï¼‰
- [ ] åˆ›å»ºèŠ‚ç‚¹ç®¡ç† API

### Phase 2: ä»»åŠ¡åˆ†å‘ï¼ˆç¬¬2å‘¨ï¼‰

- [ ] å®ç°ä»»åŠ¡åˆ†å‘å™¨
- [ ] åˆ›å»º Worker å®¢æˆ·ç«¯ç¨‹åº
- [ ] å®ç° Master-Worker WebSocket é€šä¿¡
- [ ] æ·»åŠ ä»»åŠ¡çŠ¶æ€åŒæ­¥
- [ ] å®ç°ç»“æœå›ä¼ æœºåˆ¶

### Phase 3: å‰ç«¯ç•Œé¢ï¼ˆç¬¬3å‘¨ï¼‰

- [ ] åˆ›å»ºèŠ‚ç‚¹ç®¡ç†é¢æ¿
- [ ] æ·»åŠ èŠ‚ç‚¹é€‰æ‹©å™¨
- [ ] å®ç°èŠ‚ç‚¹çŠ¶æ€å®æ—¶æ›´æ–°
- [ ] æ·»åŠ ä»»åŠ¡æ‰§è¡Œç›‘æ§
- [ ] åˆ›å»ºåˆ†å¸ƒå¼ä»»åŠ¡å†å²é¡µé¢

### Phase 4: ä¼˜åŒ–å’Œæµ‹è¯•ï¼ˆç¬¬4å‘¨ï¼‰

- [ ] é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] å®‰å…¨æ€§å¢å¼ºï¼ˆAPI å¯†é’¥è®¤è¯ï¼‰
- [ ] å®Œæ•´æµ‹è¯•
- [ ] æ–‡æ¡£ç¼–å†™

---

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

ç°åœ¨æˆ‘å°†å¼€å§‹å®ç°è¿™ä¸ªæ¶æ„ã€‚æ˜¯å¦æŒ‰ç…§ä»¥ä¸‹é¡ºåºè¿›è¡Œï¼Ÿ

1. **åˆ›å»ºç±»å‹å®šä¹‰å’Œæ¥å£** - å®šä¹‰æ•°æ®ç»“æ„
2. **å®ç° Worker å®¢æˆ·ç«¯** - ç‹¬ç«‹çš„ Worker ç¨‹åº
3. **æ‰©å±• Master æœåŠ¡å™¨** - æ·»åŠ èŠ‚ç‚¹ç®¡ç†åŠŸèƒ½
4. **åˆ›å»ºå‰ç«¯ç•Œé¢** - èŠ‚ç‚¹é€‰æ‹©å’Œç›‘æ§
5. **ç¼–å†™éƒ¨ç½²æ–‡æ¡£** - å®Œæ•´çš„ä½¿ç”¨æŒ‡å—

è¯·ç¡®è®¤æ˜¯å¦å¼€å§‹å®ç°ï¼Œæˆ–è€…æ‚¨æœ‰å…¶ä»–ä¼˜å…ˆçº§å»ºè®®ï¼Ÿ
