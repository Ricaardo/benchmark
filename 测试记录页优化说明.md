# ğŸ“Š æµ‹è¯•è®°å½•é¡µé¢ä¼˜åŒ–è¯´æ˜

## âœ… ä¼˜åŒ–å®Œæˆ

å·²å®Œæˆæµ‹è¯•è®°å½•é¡µé¢çš„å›¾è¡¨å±•ç¤ºä¼˜åŒ–ï¼Œæå‡ç”¨æˆ·ä½“éªŒå’Œé¡µé¢æ€§èƒ½ã€‚

---

## ğŸ¯ ä¼˜åŒ–ç›®æ ‡

1. **ç§»é™¤"åŠ è½½å›¾è¡¨"æç¤º** - ä¸å†æ˜¾ç¤º"åŠ è½½å›¾è¡¨ä¸­..."ç­‰åŠ è½½æç¤º
2. **é»˜è®¤æŠ˜å å›¾è¡¨** - æ‰€æœ‰æµ‹è¯•è®°å½•é»˜è®¤æŠ˜å ï¼Œç‚¹å‡»å±•å¼€æ‰åŠ è½½å›¾è¡¨æ•°æ®
3. **ä¼˜åŒ–å›¾è¡¨æ ·å¼** - ç»Ÿä¸€å›¾è¡¨å¡ç‰‡æ ·å¼ï¼Œæå‡è§†è§‰æ•ˆæœ

---

## ğŸ“ ä¸»è¦å˜æ›´

### 1. **æ–°å¢ä¸“ç”¨æ ·å¼æ–‡ä»¶**

åˆ›å»º `/public/css/records.css` åŒ…å«ï¼š

#### æŠ˜å /å±•å¼€åŠŸèƒ½æ ·å¼
```css
/* å±•å¼€å›¾æ ‡ */
.expand-icon {
    display: inline-block;
    transition: transform 0.2s ease;
}

.expand-icon.expanded {
    transform: rotate(90deg);  /* å±•å¼€æ—¶æ—‹è½¬90åº¦ */
}

/* å›¾è¡¨è¡Œé»˜è®¤éšè— */
.chart-row {
    display: none;
}

.chart-row.visible {
    display: table-row;
    animation: slideDown 0.3s ease;  /* å¹³æ»‘å±•å¼€åŠ¨ç”» */
}
```

#### å›¾è¡¨å®¹å™¨æ ·å¼
```css
.chart-container {
    padding: 24px;
    background: #ffffff;
    border-top: 2px solid #e5e7eb;
}

.chart-card {
    background: #ffffff;
    padding: 20px;
    border-radius: 12px;
    margin-bottom: 20px;
    border: 1px solid #e5e7eb;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
}

.chart-wrapper {
    width: 100%;
    height: 300px;
    background: #ffffff;
    border-radius: 8px;
    padding: 12px;
}
```

#### æŒ‡æ ‡å¡ç‰‡ç½‘æ ¼
```css
.metrics-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmin(180px, 1fr));
    gap: 16px;
}

.metric-card {
    background: #ffffff;
    padding: 16px;
    border-radius: 10px;
    border-left: 4px solid #3b82f6;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.metric-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}
```

#### ç»Ÿè®¡è¡¨æ ¼ä¼˜åŒ–
```css
.stats-table {
    width: 100%;
    border-collapse: collapse;
    border-radius: 12px;
    overflow: hidden;
}

.stats-diff-positive {
    color: #dc2626;  /* æ­£å·®è· - çº¢è‰²ï¼ˆæ€§èƒ½ä¸‹é™ï¼‰*/
    font-weight: 600;
}

.stats-diff-negative {
    color: #059669;  /* è´Ÿå·®è· - ç»¿è‰²ï¼ˆæ€§èƒ½æå‡ï¼‰*/
    font-weight: 600;
}
```

### 2. **ä¿®æ”¹HTMLæ¸²æŸ“é€»è¾‘**

#### ç§»é™¤åŠ è½½æç¤º
**ä¼˜åŒ–å‰**ï¼š
```javascript
if (record.reportFile) {
    chartTd.innerHTML = `
        <div class="chart-container" id="chart-container-${record.id}">
            <div class="loading-chart">åŠ è½½å›¾è¡¨ä¸­...</div>
        </div>
    `;
}
```

**ä¼˜åŒ–å**ï¼š
```javascript
if (record.reportFile) {
    chartTd.innerHTML = `
        <div class="chart-container" id="chart-container-${record.id}">
            <!-- å›¾è¡¨å°†åœ¨å±•å¼€æ—¶åŠ è½½ -->
        </div>
    `;
}
```

#### ä¼˜åŒ–å±•å¼€é€»è¾‘
**ä¼˜åŒ–å‰**ï¼š
```javascript
const loadingChart = container?.querySelector('.loading-chart');
if (loadingChart && !chartsData.has(recordId)) {
    await loadAndRenderChart(recordId);
}
```

**ä¼˜åŒ–å**ï¼š
```javascript
// æ£€æŸ¥æ˜¯å¦éœ€è¦åŠ è½½å›¾è¡¨æ•°æ®ï¼ˆåªåŠ è½½ä¸€æ¬¡ï¼‰
if (!chartsData.has(recordId)) {
    const container = document.getElementById(`chart-container-${recordId}`);
    // å¦‚æœå®¹å™¨ä¸ºç©ºæˆ–åªæœ‰æ³¨é‡Šï¼Œåˆ™éœ€è¦åŠ è½½å›¾è¡¨
    if (container && container.children.length === 0) {
        await loadAndRenderChart(recordId);
    }
}
```

#### ç»Ÿä¸€å›¾è¡¨æ ·å¼ç±»
**ä¼˜åŒ–å‰**ï¼š
```html
<div style="background: white; padding: 16px; border-radius: 8px; margin-bottom: 20px; border: 1px solid #e2e8f0;">
    <h5 style="color: #4a5568; margin-bottom: 12px;">First Paint (FP)</h5>
    <div class="chart-wrapper">
        <canvas id="init-fp-${recordId}"></canvas>
    </div>
</div>
```

**ä¼˜åŒ–å**ï¼š
```html
<div class="chart-card">
    <h5>First Paint (FP)</h5>
    <div class="chart-wrapper">
        <canvas id="init-fp-${recordId}"></canvas>
    </div>
</div>
```

### 3. **å›¾è¡¨ç»„ç»‡ç»“æ„**

ä½¿ç”¨ `.charts-section` åŒ…è£…æ‰€æœ‰å›¾è¡¨ï¼š

```html
<div class="charts-section">
    <h4>æ€§èƒ½æŒ‡æ ‡å¯¹æ¯”</h4>

    <div class="chart-card">
        <h5>First Paint (FP)</h5>
        <div class="chart-wrapper">
            <canvas id="init-fp-${recordId}"></canvas>
        </div>
    </div>

    <!-- æ›´å¤šå›¾è¡¨... -->
</div>
```

---

## ğŸ¨ è§†è§‰æ”¹è¿›

### 1. **å›¾è¡¨å¡ç‰‡æ•ˆæœ**
- åœ†è§’è¾¹æ¡†ï¼š12px
- æµ…è‰²é˜´å½±ï¼š`box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05)`
- æ‚¬åœæ•ˆæœï¼šå‘ä¸Šç§»åŠ¨ 2px + å¢å¼ºé˜´å½±

### 2. **æŒ‡æ ‡å¡ç‰‡**
- ç½‘æ ¼å¸ƒå±€ï¼šè‡ªé€‚åº”åˆ—å®½
- å·¦ä¾§å½©è‰²è¾¹æ¡†ï¼š4px è“è‰²
- æ‚¬åœåŠ¨æ•ˆï¼šè½»å¾®ä¸Šæµ®

### 3. **å±•å¼€åŠ¨ç”»**
- å¹³æ»‘å±•å¼€ï¼š`slideDown 0.3s ease`
- å›¾æ ‡æ—‹è½¬ï¼š`transform: rotate(90deg)`
- æµç•…è¿‡æ¸¡æ— å¡é¡¿

### 4. **è¡¨æ ¼æ ·å¼**
- åœ†è§’è¾¹æ¡†ï¼š12px
- æ–‘é©¬çº¹è¡Œï¼šæ‚¬åœé«˜äº®
- å·®è·æŒ‡æ ‡ï¼šå½©è‰²æ ‡æ³¨ï¼ˆç»¿è‰²=æå‡ï¼Œçº¢è‰²=ä¸‹é™ï¼‰

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### 1. **æ‡’åŠ è½½æœºåˆ¶**
- å›¾è¡¨é»˜è®¤**ä¸åŠ è½½**
- åªåœ¨ç”¨æˆ·**ç‚¹å‡»å±•å¼€**æ—¶åŠ è½½
- å·²åŠ è½½çš„å›¾è¡¨**ç¼“å­˜æ•°æ®**ï¼Œä¸é‡å¤è¯·æ±‚

### 2. **å‡å°‘åˆå§‹æ¸²æŸ“**
```javascript
const chartsData = new Map();  // ç¼“å­˜å·²åŠ è½½çš„å›¾è¡¨æ•°æ®

async function toggleChartRow(recordId) {
    // ...
    if (!chartsData.has(recordId)) {  // åªåŠ è½½ä¸€æ¬¡
        await loadAndRenderChart(recordId);
    }
}
```

### 3. **DOMä¼˜åŒ–**
- ç§»é™¤ä¸å¿…è¦çš„åŠ è½½æç¤ºDOM
- ä½¿ç”¨CSSç±»æ›¿ä»£å†…è”æ ·å¼
- å‡å°‘DOMèŠ‚ç‚¹æ•°é‡

---

## ğŸ¯ ç”¨æˆ·ä½“éªŒæå‡

### ä¼˜åŒ–å‰
- âŒ è¿›å…¥é¡µé¢å°±æ˜¾ç¤º"åŠ è½½å›¾è¡¨ä¸­..."
- âŒ æ‰€æœ‰å›¾è¡¨å ç”¨å¤§é‡é¡µé¢ç©ºé—´
- âŒ é¡µé¢åŠ è½½æ…¢ï¼ˆè¯·æ±‚æ‰€æœ‰å›¾è¡¨æ•°æ®ï¼‰
- âŒ æ»šåŠ¨æŸ¥çœ‹å…¶ä»–è®°å½•å›°éš¾

### ä¼˜åŒ–å
- âœ… é»˜è®¤æŠ˜å ï¼Œç•Œé¢ç®€æ´
- âœ… ç‚¹å‡»å±•å¼€æ‰åŠ è½½å›¾è¡¨
- âœ… é¡µé¢åŠ è½½å¿«é€Ÿï¼ˆæŒ‰éœ€åŠ è½½ï¼‰
- âœ… è½»æ¾æµè§ˆå¤šæ¡è®°å½•
- âœ… å›¾æ ‡æ¸…æ™°æŒ‡ç¤ºå¯å±•å¼€çŠ¶æ€ï¼ˆâ–¶ï¼‰
- âœ… å±•å¼€åå›¾æ ‡æ—‹è½¬ï¼ˆâ–¼ï¼‰

---

## ğŸ“± å“åº”å¼æ”¯æŒ

ç§»åŠ¨ç«¯ä¼˜åŒ–ï¼š

```css
@media (max-width: 768px) {
    .chart-wrapper {
        height: 250px;  /* å‡å°é«˜åº¦ */
    }

    .metrics-grid {
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 12px;
    }

    .metric-value {
        font-size: 24px;  /* é€‚é…å°å±å¹• */
    }

    .stats-table {
        font-size: 12px;  /* ç¼©å°è¡¨æ ¼å­—ä½“ */
    }
}
```

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### 1. **å›¾è¡¨ç±»å‹æ”¯æŒ**
- **Initialization** æµ‹è¯•ï¼š6ä¸ªå›¾è¡¨ï¼ˆFP, FCP, LCP, TTFB, SRT, CLSï¼‰
- **Runtime** æµ‹è¯•ï¼š9ä¸ªå›¾è¡¨ï¼ˆCPU Total/Thread, Heap, DOM Nodes, Event Listeners, CPU Script/Style/Layout, Long Tasksï¼‰
- **MemoryLeak** æµ‹è¯•ï¼šå¤ç”¨ Runtime å›¾è¡¨æ¸²æŸ“é€»è¾‘

### 2. **é”™è¯¯å¤„ç†**
- å¤±è´¥çš„æµ‹è¯•ç›´æ¥æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼ˆä¸å¯æŠ˜å ï¼‰
- æ²¡æœ‰æŠ¥å‘Šæ–‡ä»¶ä½†æœ‰é”™è¯¯ä¿¡æ¯æ—¶ç«‹å³å±•ç¤º
- é¿å…æ— æ„ä¹‰çš„å±•å¼€æ“ä½œ

### 3. **çŠ¶æ€ç®¡ç†**
```javascript
const chartsData = new Map();  // å›¾è¡¨æ•°æ®ç¼“å­˜

// å­˜å‚¨æ ¼å¼
chartsData.set(recordId, {
    record: recordObject,
    reportData: reportDataObject
});
```

---

## ğŸ“„ æ–‡ä»¶æ¸…å•

### æ–°å¢æ–‡ä»¶
- `/public/css/records.css` - æµ‹è¯•è®°å½•é¡µä¸“ç”¨æ ·å¼ï¼ˆ~500è¡Œï¼‰

### ä¿®æ”¹æ–‡ä»¶
- `/public/records.html` - å¼•å…¥æ–°æ ·å¼ï¼Œä¿®æ”¹æ¸²æŸ“é€»è¾‘

---

## ğŸ¯ ä¼˜åŒ–æ•ˆæœå¯¹æ¯”

| æ–¹é¢ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å |
|------|--------|--------|
| **åˆå§‹åŠ è½½** | æ˜¾ç¤º"åŠ è½½ä¸­..." | ç›´æ¥æ˜¾ç¤ºè®°å½•åˆ—è¡¨ |
| **æ•°æ®è¯·æ±‚** | ç«‹å³è¯·æ±‚æ‰€æœ‰å›¾è¡¨ | æŒ‰éœ€è¯·æ±‚ï¼ˆå±•å¼€æ—¶ï¼‰|
| **é¡µé¢é«˜åº¦** | å¾ˆé•¿ï¼ˆæ‰€æœ‰å›¾è¡¨å±•å¼€ï¼‰| ç®€æ´ï¼ˆé»˜è®¤æŠ˜å ï¼‰|
| **æ»šåŠ¨æŸ¥çœ‹** | å›°éš¾ï¼ˆéœ€æ»šåŠ¨å¾ˆé•¿ï¼‰| è½»æ¾ï¼ˆè®°å½•ç´§å‡‘ï¼‰|
| **å›¾è¡¨æ ·å¼** | å†…è”æ ·å¼æ··ä¹± | ç»Ÿä¸€CSSç±»ç®¡ç† |
| **è§†è§‰æ•ˆæœ** | æ™®é€š | ç²¾è‡´ï¼ˆåœ†è§’ã€é˜´å½±ã€åŠ¨ç”»ï¼‰|
| **å“åº”å¼** | ä¸€èˆ¬ | å®Œå–„ï¼ˆç§»åŠ¨ç«¯ä¼˜åŒ–ï¼‰|
| **æ€§èƒ½** | è¾ƒæ…¢ | å¿«é€Ÿï¼ˆæ‡’åŠ è½½ï¼‰|

---

## ğŸš€ ä½¿ç”¨è¯´æ˜

### æŸ¥çœ‹å›¾è¡¨
1. è¿›å…¥æµ‹è¯•è®°å½•é¡µé¢ï¼šhttp://localhost:3000/records.html
2. æ‰¾åˆ°æƒ³æŸ¥çœ‹çš„æµ‹è¯•è®°å½•
3. ç‚¹å‡»è®°å½•è¡Œæˆ–å±•å¼€å›¾æ ‡ï¼ˆâ–¶ï¼‰
4. å›¾è¡¨è‡ªåŠ¨åŠ è½½å¹¶å±•ç¤º
5. å†æ¬¡ç‚¹å‡»å¯æŠ˜å å›¾è¡¨ï¼ˆâ–¼ï¼‰

### å›¾è¡¨åŠŸèƒ½
- **Initialization å›¾è¡¨**ï¼šæŸ¥çœ‹é¡µé¢åŠ è½½æ€§èƒ½æŒ‡æ ‡
- **Runtime å›¾è¡¨**ï¼šæŸ¥çœ‹è¿è¡Œæ—¶æ€§èƒ½ç›‘æ§æ•°æ®
- **ç»Ÿè®¡è¡¨æ ¼**ï¼šå¯¹æ¯”å¤šä¸ªURLçš„æ€§èƒ½å·®å¼‚
- **Long Tasks**ï¼šæŸ¥çœ‹é•¿ä»»åŠ¡æ—¶é—´çº¿

---

## âœ… ä¼˜åŒ–æ€»ç»“

### æ ¸å¿ƒæ”¹è¿›
1. âœ… ç§»é™¤"åŠ è½½å›¾è¡¨ä¸­..."æç¤º
2. âœ… é»˜è®¤æŠ˜å æ‰€æœ‰å›¾è¡¨
3. âœ… æŒ‰éœ€æ‡’åŠ è½½å›¾è¡¨æ•°æ®
4. âœ… ç»Ÿä¸€å›¾è¡¨å¡ç‰‡æ ·å¼
5. âœ… ä¼˜åŒ–æŒ‡æ ‡å±•ç¤ºå¸ƒå±€
6. âœ… å¢å¼ºè¡¨æ ¼è§†è§‰æ•ˆæœ
7. âœ… æ·»åŠ å¹³æ»‘å±•å¼€åŠ¨ç”»
8. âœ… å®Œå–„ç§»åŠ¨ç«¯é€‚é…

### ç”¨æˆ·ä½“éªŒ
- é¡µé¢åŠ è½½æ›´å¿«é€Ÿ
- ç•Œé¢æ›´åŠ ç®€æ´
- æ“ä½œæ›´åŠ æµç•…
- è§†è§‰æ›´åŠ ç²¾è‡´

### æŠ€æœ¯å®ç°
- æ‡’åŠ è½½æœºåˆ¶
- æ•°æ®ç¼“å­˜ä¼˜åŒ–
- CSSæ¨¡å—åŒ–ç®¡ç†
- å“åº”å¼å¸ƒå±€

---

**ä¼˜åŒ–å®Œæˆæ—¶é—´**: 2025-12-02
**ä¼˜åŒ–æ–‡ä»¶**: records.html, records.css
**çŠ¶æ€**: âœ… å·²å®Œæˆå¹¶æµ‹è¯•

ğŸ‰ **æµ‹è¯•è®°å½•é¡µé¢ç°åœ¨æ›´ç®€æ´ã€æ›´å¿«é€Ÿã€æ›´æ˜“ç”¨äº†ï¼**
