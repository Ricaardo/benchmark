<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APIç®¡ç† - Benchmark Web Runner</title>

    <!-- ç»Ÿä¸€è®¾è®¡ç³»ç»Ÿ -->
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/navigation.css">
    <link rel="stylesheet" href="/css/animations.css">
    <link rel="stylesheet" href="/css/enhanced-ui.css">
</head>
<body>
    <div class="container">
        <!-- å…¨å±€å¯¼èˆªæ  -->
        <nav class="navbar animate-fade-in-down" id="main-navbar">
            <a href="/" class="navbar-brand">
                <span class="navbar-logo">ğŸš€</span>
                <div>
                    <h1 class="navbar-title">Benchmark Web Runner</h1>
                    <p class="navbar-subtitle">ç”¨ä¾‹é©±åŠ¨çš„æ€§èƒ½æµ‹è¯•å¹³å°</p>
                </div>
            </a>

            <button class="navbar-toggle" id="navbar-toggle" onclick="toggleMobileMenu()">
                <span class="navbar-toggle-bar"></span>
                <span class="navbar-toggle-bar"></span>
                <span class="navbar-toggle-bar"></span>
            </button>

            <div class="navbar-menu" id="navbar-menu">
                <a href="/" class="navbar-item">
                    <span>ğŸ“‹</span> ç”¨ä¾‹ç®¡ç†
                </a>
                <a href="/records.html" class="navbar-item">
                    <span>ğŸ“Š</span> æµ‹è¯•è®°å½•
                </a>
                <a href="/workers.html" class="navbar-item">
                    <span>ğŸ–¥ï¸</span> èŠ‚ç‚¹ç®¡ç†
                </a>
                <a href="/api.html" class="navbar-item active">
                    <span>ğŸ”‘</span> APIç®¡ç†
                </a>
            </div>

            <div class="navbar-actions">
                <a href="/debug.html" class="btn btn-secondary btn-sm">
                    <span>ğŸ”</span> APIè°ƒè¯•
                </a>
            </div>
        </nav>

        <!-- APIæ–‡æ¡£ -->
        <div class="card animate-fade-in-up">
            <h2>ğŸ”‘ APIæ¥å£æ–‡æ¡£</h2>
            <p class="text-muted">Benchmark Web Runner RESTful API æ–‡æ¡£</p>
        </div>

        <!-- APIç«¯ç‚¹åˆ—è¡¨ -->
        <div class="card animate-fade-in-up">
            <h3>ğŸ“¡ å¯ç”¨ç«¯ç‚¹</h3>

            <!-- æµ‹è¯•ç”¨ä¾‹API -->
            <div class="card" style="margin-top: 20px; background: var(--color-primary-50);">
                <h4>æµ‹è¯•ç”¨ä¾‹ç®¡ç†</h4>

                <div class="api-endpoint" style="margin: 15px 0; padding: 15px; background: white; border-radius: 8px; border-left: 4px solid var(--color-primary-500);">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                        <span class="badge badge-success">GET</span>
                        <code style="font-size: 1.05em;">/api/testcases</code>
                    </div>
                    <p style="margin: 8px 0; color: var(--color-gray-700);">è·å–æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹åˆ—è¡¨</p>
                    <details style="margin-top: 10px;">
                        <summary style="cursor: pointer; color: var(--color-primary-600); font-weight: 500;">æŸ¥çœ‹å“åº”ç¤ºä¾‹</summary>
                        <pre style="margin-top: 10px; padding: 12px; background: var(--color-gray-100); border-radius: 6px; overflow-x: auto; font-size: 0.85em;">{
  "testCases": [
    {
      "id": "uuid",
      "name": "æµ‹è¯•ç”¨ä¾‹åç§°",
      "runner": "Initialization",
      "urls": ["https://example.com"],
      "status": "idle",
      "createdAt": "2024-01-01T00:00:00.000Z"
    }
  ]
}</pre>
                    </details>
                </div>

                <div class="api-endpoint" style="margin: 15px 0; padding: 15px; background: white; border-radius: 8px; border-left: 4px solid var(--color-success-500);">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                        <span class="badge badge-primary">POST</span>
                        <code style="font-size: 1.05em;">/api/testcases</code>
                    </div>
                    <p style="margin: 8px 0; color: var(--color-gray-700);">åˆ›å»ºæ–°çš„æµ‹è¯•ç”¨ä¾‹</p>
                    <details style="margin-top: 10px;">
                        <summary style="cursor: pointer; color: var(--color-primary-600); font-weight: 500;">æŸ¥çœ‹è¯·æ±‚ä½“</summary>
                        <pre style="margin-top: 10px; padding: 12px; background: var(--color-gray-100); border-radius: 6px; overflow-x: auto; font-size: 0.85em;">{
  "name": "æµ‹è¯•ç”¨ä¾‹åç§°",
  "runner": "Initialization | Runtime | MemoryLeak",
  "urls": ["https://example.com"],
  "config": {
    "cookie": "...",
    "extraHTTPHeaders": {},
    "blockList": []
  }
}</pre>
                    </details>
                </div>

                <div class="api-endpoint" style="margin: 15px 0; padding: 15px; background: white; border-radius: 8px; border-left: 4px solid var(--color-warning-500);">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                        <span class="badge badge-warning">PUT</span>
                        <code style="font-size: 1.05em;">/api/testcases/:id</code>
                    </div>
                    <p style="margin: 8px 0; color: var(--color-gray-700);">æ›´æ–°æŒ‡å®šæµ‹è¯•ç”¨ä¾‹</p>
                </div>

                <div class="api-endpoint" style="margin: 15px 0; padding: 15px; background: white; border-radius: 8px; border-left: 4px solid var(--color-danger-500);">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                        <span class="badge badge-danger">DELETE</span>
                        <code style="font-size: 1.05em;">/api/testcases/:id</code>
                    </div>
                    <p style="margin: 8px 0; color: var(--color-gray-700);">åˆ é™¤æŒ‡å®šæµ‹è¯•ç”¨ä¾‹</p>
                </div>
            </div>

            <!-- æµ‹è¯•è®°å½•API -->
            <div class="card" style="margin-top: 20px; background: var(--color-success-50);">
                <h4>æµ‹è¯•è®°å½•ç®¡ç†</h4>

                <div class="api-endpoint" style="margin: 15px 0; padding: 15px; background: white; border-radius: 8px; border-left: 4px solid var(--color-success-500);">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                        <span class="badge badge-success">GET</span>
                        <code style="font-size: 1.05em;">/api/test-records</code>
                    </div>
                    <p style="margin: 8px 0; color: var(--color-gray-700);">è·å–æ‰€æœ‰æµ‹è¯•è®°å½•</p>
                </div>

                <div class="api-endpoint" style="margin: 15px 0; padding: 15px; background: white; border-radius: 8px; border-left: 4px solid var(--color-danger-500);">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                        <span class="badge badge-danger">DELETE</span>
                        <code style="font-size: 1.05em;">/api/test-records/:id</code>
                    </div>
                    <p style="margin: 8px 0; color: var(--color-gray-700);">åˆ é™¤æŒ‡å®šæµ‹è¯•è®°å½•</p>
                </div>
            </div>

            <!-- WorkerèŠ‚ç‚¹API -->
            <div class="card" style="margin-top: 20px; background: var(--color-info-50);">
                <h4>WorkerèŠ‚ç‚¹ç®¡ç†</h4>

                <div class="api-endpoint" style="margin: 15px 0; padding: 15px; background: white; border-radius: 8px; border-left: 4px solid var(--color-info-500);">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                        <span class="badge badge-success">GET</span>
                        <code style="font-size: 1.05em;">/api/distributed/workers</code>
                    </div>
                    <p style="margin: 8px 0; color: var(--color-gray-700);">è·å–æ‰€æœ‰WorkerèŠ‚ç‚¹çŠ¶æ€</p>
                </div>

                <div class="api-endpoint" style="margin: 15px 0; padding: 15px; background: white; border-radius: 8px; border-left: 4px solid var(--color-info-500);">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                        <span class="badge badge-primary">POST</span>
                        <code style="font-size: 1.05em;">/api/distributed/workers</code>
                    </div>
                    <p style="margin: 8px 0; color: var(--color-gray-700);">æ³¨å†Œæ–°çš„WorkerèŠ‚ç‚¹</p>
                </div>

                <div class="api-endpoint" style="margin: 15px 0; padding: 15px; background: white; border-radius: 8px; border-left: 4px solid var(--color-danger-500);">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                        <span class="badge badge-danger">DELETE</span>
                        <code style="font-size: 1.05em;">/api/distributed/workers/:id</code>
                    </div>
                    <p style="margin: 8px 0; color: var(--color-gray-700);">åˆ é™¤WorkerèŠ‚ç‚¹</p>
                </div>
            </div>

            <!-- ç³»ç»ŸAPI -->
            <div class="card" style="margin-top: 20px; background: var(--color-gray-50);">
                <h4>ç³»ç»ŸçŠ¶æ€</h4>

                <div class="api-endpoint" style="margin: 15px 0; padding: 15px; background: white; border-radius: 8px; border-left: 4px solid var(--color-gray-500);">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                        <span class="badge badge-success">GET</span>
                        <code style="font-size: 1.05em;">/api/health</code>
                    </div>
                    <p style="margin: 8px 0; color: var(--color-gray-700);">å¥åº·æ£€æŸ¥ç«¯ç‚¹</p>
                </div>

                <div class="api-endpoint" style="margin: 15px 0; padding: 15px; background: white; border-radius: 8px; border-left: 4px solid var(--color-gray-500);">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                        <span class="badge badge-success">GET</span>
                        <code style="font-size: 1.05em;">/api/status</code>
                    </div>
                    <p style="margin: 8px 0; color: var(--color-gray-700);">è·å–ç³»ç»ŸçŠ¶æ€ä¿¡æ¯</p>
                </div>
            </div>
        </div>

        <!-- WebSocketæ–‡æ¡£ -->
        <div class="card animate-fade-in-up">
            <h3>ğŸ”Œ WebSocketè¿æ¥</h3>
            <div class="card" style="margin-top: 15px; background: var(--color-purple-50);">
                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                    <span class="badge" style="background: var(--color-purple-500); color: white;">WS</span>
                    <code style="font-size: 1.05em;">ws://localhost:3000</code>
                </div>
                <p style="color: var(--color-gray-700); margin: 10px 0;">
                    å®æ—¶æ¥æ”¶æµ‹è¯•çŠ¶æ€æ›´æ–°ã€WorkerçŠ¶æ€å˜åŒ–ç­‰äº‹ä»¶é€šçŸ¥
                </p>
                <details style="margin-top: 10px;">
                    <summary style="cursor: pointer; color: var(--color-primary-600); font-weight: 500;">æŸ¥çœ‹æ¶ˆæ¯æ ¼å¼</summary>
                    <pre style="margin-top: 10px; padding: 12px; background: var(--color-gray-100); border-radius: 6px; overflow-x: auto; font-size: 0.85em;">{
  "type": "testStatus" | "workerStatus" | "taskUpdate",
  "data": {
    // äº‹ä»¶ç›¸å…³æ•°æ®
  }
}</pre>
                </details>
            </div>
        </div>

        <!-- APIæµ‹è¯•å·¥å…· -->
        <div class="card animate-fade-in-up">
            <h3>ğŸ§ª å¿«é€Ÿæµ‹è¯•</h3>
            <p class="text-muted">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æµ‹è¯•APIç«¯ç‚¹</p>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-top: 20px;">
                <button class="btn btn-primary" onclick="testEndpoint('/api/health')">
                    âœ“ æµ‹è¯•å¥åº·æ£€æŸ¥
                </button>
                <button class="btn btn-success" onclick="testEndpoint('/api/testcases')">
                    ğŸ“‹ è·å–æµ‹è¯•ç”¨ä¾‹
                </button>
                <button class="btn btn-info" onclick="testEndpoint('/api/distributed/workers')">
                    ğŸ–¥ï¸ è·å–Workeråˆ—è¡¨
                </button>
                <button class="btn btn-secondary" onclick="testEndpoint('/api/status')">
                    ğŸ“Š è·å–ç³»ç»ŸçŠ¶æ€
                </button>
            </div>

            <div id="test-result" style="margin-top: 20px;"></div>
        </div>
    </div>

    <script>
        // APIæµ‹è¯•åŠŸèƒ½
        async function testEndpoint(endpoint) {
            const resultDiv = document.getElementById('test-result');
            resultDiv.innerHTML = '<div class="loading">æ­£åœ¨è¯·æ±‚...</div>';

            try {
                const startTime = Date.now();
                const response = await fetch(endpoint);
                const duration = Date.now() - startTime;
                const data = await response.json();

                resultDiv.innerHTML = `
                    <div class="card" style="background: var(--color-success-50); border-left: 4px solid var(--color-success-500);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <h4 style="margin: 0; color: var(--color-success-700);">âœ“ è¯·æ±‚æˆåŠŸ</h4>
                            <span class="badge badge-success">HTTP ${response.status}</span>
                        </div>
                        <p style="margin: 8px 0; color: var(--color-gray-600);">
                            <strong>ç«¯ç‚¹:</strong> ${endpoint}<br>
                            <strong>è€—æ—¶:</strong> ${duration}ms
                        </p>
                        <details style="margin-top: 10px;">
                            <summary style="cursor: pointer; color: var(--color-primary-600); font-weight: 500;">æŸ¥çœ‹å“åº”æ•°æ®</summary>
                            <pre style="margin-top: 10px; padding: 12px; background: white; border-radius: 6px; overflow-x: auto; font-size: 0.85em;">${JSON.stringify(data, null, 2)}</pre>
                        </details>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="card" style="background: var(--color-danger-50); border-left: 4px solid var(--color-danger-500);">
                        <h4 style="color: var(--color-danger-700);">âœ— è¯·æ±‚å¤±è´¥</h4>
                        <p style="color: var(--color-gray-700); margin: 10px 0;">
                            <strong>ç«¯ç‚¹:</strong> ${endpoint}<br>
                            <strong>é”™è¯¯:</strong> ${error.message}
                        </p>
                    </div>
                `;
            }
        }

        // å¯¼èˆªæ äº¤äº’
        function toggleMobileMenu() {
            const toggle = document.getElementById('navbar-toggle');
            const menu = document.getElementById('navbar-menu');
            if (toggle && menu) {
                toggle.classList.toggle('active');
                menu.classList.toggle('show');
            }
        }

        window.addEventListener('scroll', function() {
            const navbar = document.getElementById('main-navbar');
            if (navbar) {
                if (window.scrollY > 20) {
                    navbar.classList.add('navbar-scrolled');
                } else {
                    navbar.classList.remove('navbar-scrolled');
                }
            }
        });
    </script>
</body>
</html>
